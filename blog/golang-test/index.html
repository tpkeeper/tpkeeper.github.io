<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.71.0-DEV" />


<title>Golang 单元测试 - 大远的博客</title>
<meta property="og:title" content="Golang 单元测试 - 大远的博客">


  <link href='http://www.tpkeep.com/favicon.jpg' rel='icon' type='image/x-icon'/>



  










<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/%3cnil%3e"
         width=""
         height=""
         alt="">
  </a>

  <ul class="nav-links">
    
    <li><a href="/">首页</a></li>
    
    <li><a href="/post">归档</a></li>
    
    <li><a href="/tags">标签</a></li>
    
    <li><a href="/categories">分类</a></li>
    
    <li><a href="/about">关于</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">1 min read</span>
    

    <h1 class="article-title">Golang 单元测试</h1>

    
    <span class="article-date">2019-11-25</span>
    

    <div class="article-content">
      <h2 id="简单使用">简单使用</h2>
<p>进入 package 所在目录，执行以下命令,该命令只会输出最终的测试结果：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go test
</code></pre></div><p>输出：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PASS
ok      addrtool        0.519s
</code></pre></div><p>使用 <code>-v</code> 参数，可以查看更多测试信息：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go test -v
</code></pre></div><p>输出：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">===</span> RUN   TestPubkeyToAddress
--- PASS: TestPubkeyToAddress <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestDcrPubkeyToAddress
--- PASS: TestDcrPubkeyToAddress <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestGenMnemonicBip39
--- PASS: TestGenMnemonicBip39 <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestMnemonicToSeedBip39
--- PASS: TestMnemonicToSeedBip39 <span style="color:#f92672">(</span>0.01s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestSeedToPubkey
--- PASS: TestSeedToPubkey <span style="color:#f92672">(</span>0.02s<span style="color:#f92672">)</span>
<span style="color:#f92672">===</span> RUN   TestPubkeyFromExtendKey
--- PASS: TestPubkeyFromExtendKey <span style="color:#f92672">(</span>0.00s<span style="color:#f92672">)</span>
PASS
ok      addrtool        0.132s

</code></pre></div><h2 id="测试覆盖率">测试覆盖率：</h2>
<p>测试覆盖率简单的说就是测试代码运行时执行到的代码行数，占用总代码行数的百分比。</p>
<p>使用以下命令可以简单的显示测试代码的覆盖率：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go test -cover
</code></pre></div><p>输出：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PASS
coverage: 35.2% of statements
ok      addrtool        0.529s
</code></pre></div><p>如果要具体查看哪些代码未覆盖，哪些代码覆盖了，则需要以下步骤，先生成轮廓图再生成 html 文件：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go test -coverprofile<span style="color:#f92672">=</span>./testdata/covprofile 

go tool cover -html<span style="color:#f92672">=</span>./testdata/covprofile -o ./testdata/coverage.html
</code></pre></div><p>然后在浏览器中打开生成的 html 文件，绿色的表示已经覆盖的代码，红色的表示还没有覆盖的代码，一目了然：</p>
<p><img src="/image/test_html.png" alt="test.png"></p>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js//highlight.min.js"></script>



<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-166290945-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

